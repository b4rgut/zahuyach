<!doctype html>
<html lang="{{site.language}}" data-theme="dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="{{#if page.description}}{{page.description}}{{else}}{{site.description}}{{/if}}"
        />
        <meta name="author" content="{{site.author}}" />
        <meta name="generator" content="Zahuyach" />

        <!-- Preconnect to external domains -->
        <link
            rel="preconnect"
            href="https://fonts.googleapis.com"
            crossorigin
        />

        <!-- Critical CSS inline for fast initial paint -->
        <style>
            /* GitHub color scheme */
            :root[data-theme="light"] {
                --color-canvas-default: #ffffff;
                --color-canvas-subtle: #f6f8fa;
                --color-canvas-inset: #f6f8fa;
                --color-fg-default: #1f2328;
                --color-fg-muted: #656d76;
                --color-fg-subtle: #6e7781;
                --color-fg-on-emphasis: #ffffff;
                --color-border-default: #d0d7de;
                --color-border-muted: #d8dee4;
                --color-accent-fg: #0969da;
                --color-accent-emphasis: #0969da;
                --color-accent-subtle: #ddf4ff;
                --color-success-fg: #1a7f37;
                --color-danger-fg: #cf222e;
                --color-warning-fg: #9a6700;
                --color-done-fg: #8250df;
            }

            :root[data-theme="dark"] {
                --color-canvas-default: #0d1117;
                --color-canvas-subtle: #161b22;
                --color-canvas-inset: #010409;
                --color-fg-default: #e6edf3;
                --color-fg-muted: #7d8590;
                --color-fg-subtle: #6e7681;
                --color-fg-on-emphasis: #ffffff;
                --color-border-default: #30363d;
                --color-border-muted: #21262d;
                --color-accent-fg: #58a6ff;
                --color-accent-emphasis: #1f6feb;
                --color-accent-subtle: #0c2d6b;
                --color-success-fg: #3fb950;
                --color-danger-fg: #f85149;
                --color-warning-fg: #d29922;
                --color-done-fg: #a371f7;
            }

            /* Reset and base styles */
            *,
            *::before,
            *::after {
                box-sizing: border-box;
            }

            body {
                margin: 0;
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans",
                    Helvetica, Arial, sans-serif;
                font-size: 16px;
                line-height: 1.5;
                color: var(--color-fg-default);
                background-color: var(--color-canvas-default);
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            /* Prevent FOUC */
            .no-js .js-only {
                display: none;
            }

            /* Theme transition */
            body.theme-transition,
            body.theme-transition *,
            body.theme-transition *::before,
            body.theme-transition *::after {
                transition:
                    background-color 0.3s ease,
                    color 0.3s ease,
                    border-color 0.3s ease !important;
            }
        </style>

        <!-- Preload critical resources -->
        <link rel="preload" href="/static/css/main.css" as="style" />
        <link rel="preload" href="/static/js/theme.js" as="script" />

        <title>
            {{#if page.title}}{{page.title}} -
            {{site.title}}{{else}}{{site.title}}{{/if}}
        </title>

        <!-- Open Graph -->
        <meta
            property="og:title"
            content="{{#if page.title}}{{page.title}}{{else}}{{site.title}}{{/if}}"
        />
        <meta
            property="og:description"
            content="{{#if page.description}}{{page.description}}{{else}}{{site.description}}{{/if}}"
        />
        <meta
            property="og:type"
            content="{{#if page.type}}{{page.type}}{{else}}website{{/if}}"
        />
        <meta property="og:url" content="{{site.base_url}}{{page.url}}" />

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary" />
        <meta
            name="twitter:title"
            content="{{#if page.title}}{{page.title}}{{else}}{{site.title}}{{/if}}"
        />
        <meta
            name="twitter:description"
            content="{{#if page.description}}{{page.description}}{{else}}{{site.description}}{{/if}}"
        />

        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
        <link rel="alternate icon" href="/static/favicon.ico" />

        <!-- RSS -->
        <link
            rel="alternate"
            type="application/rss+xml"
            title="{{site.title}}"
            href="/feed.xml"
        />

        <!-- Theme detection script (must run before body renders) -->
        <script>
            (function () {
                const theme =
                    localStorage.getItem("theme") ||
                    (window.matchMedia("(prefers-color-scheme: light)").matches
                        ? "light"
                        : "dark");
                document.documentElement.setAttribute("data-theme", theme);
            })();
        </script>

        <!-- Main styles -->
        <link rel="stylesheet" href="/static/css/main.css" />

        <!-- Remove no-js class -->
        <script>
            document.documentElement.classList.remove("no-js");
        </script>
    </head>
    <body>
        <a href="#main" class="skip-link">Skip to main content</a>

        <header class="site-header">
            <nav class="container nav" aria-label="Main">
                <a href="/" class="nav-logo" aria-label="{{site.title}} - Home">
                    {{#if site.logo}}
                    <img
                        src="{{site.logo}}"
                        alt="{{site.title}}"
                        width="32"
                        height="32"
                        loading="lazy"
                    />
                    {{else}}
                    <span class="nav-title">{{site.title}}</span>
                    {{/if}}
                </a>

                <button
                    class="nav-toggle js-only"
                    aria-label="Toggle navigation"
                    aria-expanded="false"
                    aria-controls="nav-menu"
                >
                    <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        aria-hidden="true"
                    >
                        <path d="M3 12h18M3 6h18M3 18h18" />
                    </svg>
                </button>

                <ul class="nav-menu" id="nav-menu">
                    <li>
                        <a
                            href="/"
                            class="nav-link {{#if is_home}}active{{/if}}"
                            >Home</a
                        >
                    </li>
                    <li>
                        <a
                            href="/archive"
                            class="nav-link {{#if is_archive}}active{{/if}}"
                            >Archive</a
                        >
                    </li>
                    <li>
                        <a
                            href="/tags"
                            class="nav-link {{#if is_tags}}active{{/if}}"
                            >Tags</a
                        >
                    </li>
                    <li>
                        <a
                            href="/about"
                            class="nav-link {{#if is_about}}active{{/if}}"
                            >About</a
                        >
                    </li>
                    <li>
                        <button
                            class="theme-toggle js-only"
                            aria-label="Toggle theme"
                        >
                            <svg
                                class="theme-icon-light"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                aria-hidden="true"
                            >
                                <circle cx="12" cy="12" r="5" />
                                <path
                                    d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24"
                                />
                            </svg>
                            <svg
                                class="theme-icon-dark"
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                aria-hidden="true"
                            >
                                <path
                                    d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"
                                />
                            </svg>
                        </button>
                    </li>
                </ul>
            </nav>
        </header>

        <main id="main" class="main">
            <div class="container">{{> content}}</div>
        </main>

        <footer class="site-footer">
            <div class="container footer-content">
                <div class="footer-info">
                    <p>
                        &copy; {{current_year}} {{site.title}}. All rights
                        reserved.
                    </p>
                    <p class="footer-meta">
                        Powered by
                        <a
                            href="https://github.com/zahuyach/zahuyach"
                            rel="noopener"
                            target="_blank"
                            >Zahuyach</a
                        >
                    </p>
                </div>

                <nav class="footer-links" aria-label="Social links">
                    {{#if site.social.github}}
                    <a
                        href="{{site.social.github}}"
                        class="social-link"
                        aria-label="GitHub"
                        rel="noopener"
                        target="_blank"
                    >
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                            aria-hidden="true"
                        >
                            <path
                                d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"
                            />
                        </svg>
                    </a>
                    {{/if}} {{#if site.social.twitter}}
                    <a
                        href="{{site.social.twitter}}"
                        class="social-link"
                        aria-label="Twitter"
                        rel="noopener"
                        target="_blank"
                    >
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="currentColor"
                            aria-hidden="true"
                        >
                            <path
                                d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"
                            />
                        </svg>
                    </a>
                    {{/if}} {{#if site.social.email}}
                    <a
                        href="mailto:{{site.social.email}}"
                        class="social-link"
                        aria-label="Email"
                    >
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            aria-hidden="true"
                        >
                            <rect x="2" y="4" width="20" height="16" rx="2" />
                            <path d="m22 7-10 5L2 7" />
                        </svg>
                    </a>
                    {{/if}}
                    <a
                        href="/feed.xml"
                        class="social-link"
                        aria-label="RSS Feed"
                    >
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            aria-hidden="true"
                        >
                            <path d="M4 11a9 9 0 019 9M4 4a16 16 0 0116 16" />
                            <circle cx="5" cy="19" r="1" />
                        </svg>
                    </a>
                </nav>
            </div>
        </footer>

        <!-- Minimal theme script -->
        <script src="/static/js/theme.js" defer></script>

        <!-- Navigation script (only if needed) -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const toggle = document.querySelector(".nav-toggle");
                const menu = document.querySelector(".nav-menu");

                if (toggle && menu) {
                    toggle.addEventListener("click", function () {
                        const isOpen =
                            toggle.getAttribute("aria-expanded") === "true";
                        toggle.setAttribute("aria-expanded", !isOpen);
                        menu.classList.toggle("is-open");
                    });
                }
            });
        </script>
    </body>
</html>
